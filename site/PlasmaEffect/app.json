[{"name":"app.R","content":"webr::install(\"RcppColors\")\r\n\r\nlibrary(RcppColors)\r\nlibrary(shiny)\r\n\r\n\r\nplasma <- function(x, y, w, h) {\r\n  (128 + (128 * sin(x/16))\r\n   + 128 + (128 * sin(y/32))\r\n   + 128 + (128 * sin(sqrt((x - w/2)*(x - w/2) + (y - h/2)*(y - h/2)) / 8))\r\n   + 128 + (128 * sin(sqrt(x*x + y*y) / 8))) / 4\r\n}\r\n\r\nx_ <- y_ <- seq(-127, 127, length.out = 512L)\r\nZimg <- function(w1, h1, w2, h2) {\r\n  Mre <- outer(x_, y_, plasma, w = w1, h = h1)\r\n  Mim <- outer(x_, y_, plasma, w = w2, h = h2)\r\n  Z <- complex(real = Mre, imaginary = Mim)\r\n  dim(Z) <- c(512L, 512L)\r\n  Z  \r\n}\r\n\r\n\r\n#### SHINY APP ----####\r\n\r\nui <- fluidPage(\r\n  br(),\r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      selectInput(\r\n        \"colormap\", \"Color map\",\r\n        choices = paste0(\"colorMap\", c(1L, 2L, 4L:14L))\r\n      ),\r\n      sliderInput(\r\n        \"nrmlz\", \"normalization\", min = 1, max = 256, step = 5, value = 256\r\n      ),\r\n      splitLayout(\r\n        sliderInput(\"w1\", \"w1\", min = 0, max = 200, step = 4, value = 40),\r\n        sliderInput(\"h1\", \"h1\", min = 0, max = 200, step = 4, value = 40)\r\n      ),\r\n      splitLayout(\r\n        sliderInput(\"w2\", \"w2\", min = 0, max = 200, step = 4, value = 160),\r\n        sliderInput(\"h2\", \"h2\", min = 0, max = 200, step = 4, value = 160)\r\n      ),\r\n      width = 6\r\n    ),\r\n    mainPanel(\r\n      plotOutput(\"plasma\"),\r\n      width = 6\r\n    )\r\n  )\r\n) \r\n\r\n\r\nserver <- function(input, output, session) {\r\n  \r\n  Z0 <- reactive({\r\n    Zimg(\r\n      input[[\"w1\"]], input[[\"h1\"]], input[[\"w2\"]], input[[\"h2\"]]\r\n    )\r\n  })\r\n  \r\n  Z1 <- reactive({\r\n    Z0() / input[[\"nrmlz\"]]\r\n  })\r\n  \r\n  Img <- reactive({\r\n    switch(\r\n      input[[\"colormap\"]],\r\n      colorMap1 = colorMap1(Z1()), \r\n      colorMap2 = colorMap2(Z1()), \r\n      colorMap4 = colorMap4(Z1()), \r\n      colorMap5 = colorMap5(Z1()), \r\n      colorMap6 = colorMap6(Z1()), \r\n      colorMap7 = colorMap7(Z1()), \r\n      colorMap8 = colorMap8(Z1()), \r\n      colorMap9 = colorMap9(Z1()), \r\n      colorMap10 = colorMap10(Z1()), \r\n      colorMap11 = colorMap11(Z1()), \r\n      colorMap12 = colorMap12(Z1()), \r\n      colorMap13 = colorMap13(Z1()), \r\n      colorMap14 = colorMap14(Z1()) \r\n    )\r\n  })\r\n  \r\n  output[[\"plasma\"]] <- renderPlot({\r\n    par(mar = c(0, 0, 0, 0))\r\n    plot(\r\n      NULL, xlim = c(0, 1), ylim = c(0, 1), asp = 1,\r\n      xlab = NA, ylab = NA, axes = FALSE, xaxs = \"i\", yaxs = \"i\"\r\n    )\r\n    rasterImage(Img(), 0, 0, 1, 1)\r\n  }, width = 512, height = 512)\r\n  \r\n}\r\n\r\n\r\nshinyApp(ui, server)\r\n","type":"text"}]
